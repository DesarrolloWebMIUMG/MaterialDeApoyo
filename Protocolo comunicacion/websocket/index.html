<!DOCTYPE html>
<html>
<head>
  <title>Chat para el Curso Desarrollo Web</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
    body {
      background-color: #4a154b;
      font-family: Arial, sans-serif;
    }

    .color-texto{
      color:#4a154b
    }

    .titulo{
      font-family: Slack-Larsseit,"Helvetica Neue",Helvetica,"Segoe UI",Tahoma,Arial,sans-serif;
      font-weight: 700;
      color:white;
    }
    .container {
      margin-top: 50px;
    }

    #messages {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="row">
      <div class="col-md-8 offset-md-2">
        <h1 class="titulo">Chat del Curso Desarrollo Web</h1>
        <div id="messages" class="bg-white p-3 rounded"></div>
        <form id="input-form" class="mt-3">
          <div class="form-group">
            <label for="username" class="titulo">Nombre de usuario:</label>
            <input type="text" id="username" name="username" class="form-control" required>
          </div>
          <div class="form-group">
            <label for="message" class="titulo">Escribe tu mensaje:</label>
            <textarea id="message" name="message" class="form-control" rows="3" required></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Enviar</button>
        </form>
      </div>
    </div>
  </div>
  
  <script>
    const webSocket = new WebSocket('ws://localhost:443/');

    webSocket.onmessage = (event) => {
      const messageData = JSON.parse(event.data);
      const messagesDiv = document.getElementById('messages');
      const messageHTML = `
        <div class="bg-light p-2 rounded mt-2">
          <strong class="color-texto">${messageData.username}:</strong> ${messageData.message}
        </div>
      `;
      messagesDiv.innerHTML += messageHTML;
    };
    
    webSocket.addEventListener("open", () => {
      console.log("Estamos conectados");
    });

    function sendMessage(event) {
      const usernameInput = document.getElementById('username');
      const messageInput = document.getElementById('message');
      const username = usernameInput.value;
      const message = messageInput.value;
      const messageObject = { username, message };
      webSocket.send(JSON.stringify(messageObject));
      messageInput.value = "";
      event.preventDefault();
    }

    document.getElementById('input-form').addEventListener('submit', sendMessage);
  </script>
</body>
</html>
